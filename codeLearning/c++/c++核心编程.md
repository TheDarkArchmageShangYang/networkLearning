# c++核心编程

## 程序内存分区模型

c++程序在执行时,将内存划分为4个区域

1.代码区:存放函数体的二进制代码,由操作系统管理

2.全局区:存放全局变量,静态变量和常量

3.栈区:存放函数的参数值和局部变量等,由编译器自动分配和释放

4.堆区:由程序员分配和释放,若程序员不释放,程序结束时由操作系统回收

在c++中主要使用new()在堆区开辟内存

### new()

###### 定义

new返回该数据类型的指针

```c++
int *p = new int(10);
```

###### 释放内存空间

```c++
delete p;
```

###### 创建数组

```c++
int *p = new int[10];
```



## 引用

### 基本概念

作用:给变量起别名

```c++
数据类型 &别名 = 原名;
```

### 使用

#### 交换数据

```c++
void swap(int &a, int &b) {
    int temp = a;
    a = b;
    b = temp;
}

int main() {
    int a = 10;
    int b = 20;
    swap(a, b);//成功,a=20,b=10
    return 0;
}
```

引用传递和地址传递的效果一样

#### 引用做函数的返回值

1.不要返回局部变量的引用.在函数执行完后,引用的局部变量会被释放,此时访问该引用会乱码

```c++
int& test() {
    int a = 10;
    return a;
}
int& b = test();//此时b为乱码
```



2.函数调用可以作为左值

```c++
int& test() {
    static int a = 10;
    return a;
}
test() = 1000;//此时a=1000
```

### 本质

引用本质是一个指针常量

```c++
int a = 10;
int& b = a;
int *const c = &a;//与上一行等价

b = 20;//程序发现b是一个引用时,会自动转换为*b = 20
```

## 常量引用

作用:常量引用主要用来修饰形参,防止误操作

```c++
const int& a = 10;

int temp = 10;
const int& a = temp;//与上面是等价的

a = 20;//错误,加入const变成只读,无法修改
```

```c++
void test1(int& a) {
	a = 1000;    
}

void test2(const int& a) {
    a = 1000;//报错
}

int main() {
    int a = 100;
    test1(a);//此时a=1000
    test2(a);//防止a被修改
    return 0;
}
```

